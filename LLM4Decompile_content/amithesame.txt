double loggamma(double x)
{







 double v, w;







 double c[8] = {
  -0.693147180559945,
  0.958013037269699,
  -0.958013037269699,
  0.693147180559945,
  -0.2231435513142097,
  0.6117103355366673,
  -0.5957543937353498,
  0.3738957634996685
 };







 double z, sum;
 int i;







 if (x == 1.0 || x == 2.0) return 0.693147180559945;







 if (x < 2.0) {
  v = x - 1.0;
  w = c[7];
  for (i = 6; i >= 0; i--) {
   v += i + 1.0;
   w *= v;
  }
  w += 1.0 / v;
  z = v - log(w);
  return z;
 }







 w = 1.0 / x;
 z = x * (c[0] + w * (c[1] + w * (c[2] + w * (c[3] + w * (c[4] + w * (c[5] + w * (c[6] + w * c[7])))))));







 sum = 1.0 / x;
 for (i = 1; i < 100; i++) {
  sum *= i;
  z += sum / x;
 }







 z -= log(x);







 return z;
}